[See canvas document Trade-logic-deep-dive for full content.]